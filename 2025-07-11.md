# 2025-07-11

## ğŸ“ ELK - ì‚¬ìš© í›„ ë¡œê·¸ ìˆ˜ì§‘ ë° ë””ë²„ê·¸

### âœ… ëª©í‘œ
- Spring Boot ë¡œê·¸ë¥¼ `.log` íŒŒì¼ë¡œ ì €ì¥
- Logstashë¥¼ í†µí•´ í•´ë‹¹ ë¡œê·¸ë¥¼ ìˆ˜ì§‘
- Elasticsearchì— ì €ì¥
- Kibanaì—ì„œ ì‹œê°í™” ë° ì¡°íšŒ

---

## 1. Spring Boot ë¡œê·¸ ì„¤ì • (`logback-spring.xml`)

```xml
<configuration>
    <property name="LOG_PATH" value="logs"/>

    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>${LOG_PATH}/app.log</file>
        <append>true</append>
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>${LOG_PATH}/app.%d{yyyy-MM-dd}.log</fileNamePattern>
            <maxHistory>30</maxHistory>
        </rollingPolicy>
    </appender>

    <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <root level="INFO">
        <appender-ref ref="FILE" />
        <appender-ref ref="CONSOLE" />
    </root>
</configuration>

```
logs/app.logì— ë¡œê·¸ íŒŒì¼ ì €ì¥

ì½˜ì†”ì—ë„ ì¶œë ¥

## 2. Logstash ì„¤ì • (logstash.conf)
   bash
````
input {
  file {
    path => "/app/logs/app.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
  }
}

filter {
  json {
    source => "message"
  }

  date {
    match => [ "@timestamp", "ISO8601" ]
    target => "@timestamp"
  }

  mutate {
    remove_field => ["host", "path"]
  }
}

output {
  elasticsearch {
    hosts => ["http://elasticsearch:9200"]
    index => "springboot-logs"
  }

  stdout {
    codec => rubydebug
  }
}
````

## ë¡œê·¸ íŒŒì¼ì—ì„œ ì½ì–´ì™€ Elasticsearchì— ì €ì¥

springboot-logs ì¸ë±ìŠ¤ë¡œ ê¸°ë¡

## 3. Kibanaì—ì„œ Index Pattern ìƒì„±
   Index pattern: springboot-logs*

Time field: @timestamp

## 4. Kibana Discoverë¡œ ë¡œê·¸ ì¡°íšŒ
   ì¢Œì¸¡ ë©”ë‰´ â†’ Discover â†’ springboot-logs* ì„ íƒ

ë¡œê·¸ê°€ ì‹œê°„ìˆœìœ¼ë¡œ ì¶œë ¥ë˜ëŠ”ì§€ í™•ì¸

ì‹œê°„ ë²”ìœ„ë„ í™•ì¸ (ìš°ì¸¡ ìƒë‹¨ â†’ "Last 15 minutes")

## 5. Kibana Visualizeë¡œ ì‹œê°í™”
````  
 ì¢Œì¸¡ ë©”ë‰´ â†’ Visualize â†’ Create Visualization
Lens ì„ íƒ
springboot-logs* ì„ íƒ
Xì¶•: @timestamp, Yì¶•: Count
ê·¸ë˜í”„ ì €ì¥
````

## 6. Kibana Dashboard ë§Œë“¤ê¸°
````
   ì¢Œì¸¡ ë©”ë‰´ â†’ Dashboard â†’ Create ì‹œê°í™” ì¶”ê°€ í›„ ì €ì¥
````
## ğŸ§  ë°°ìš´ ì 
````
soutvë¡œ í™•ì¸ í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ , ë¡œê·¸íŒŒì¼ë¡œ í™•ì¸ 

ë¡œê·¸ íŒŒì¼ ê²½ë¡œëŠ” ì ˆëŒ€ ê²½ë¡œë¡œ ì§€ì •í•˜ëŠ” ê²Œ í™•ì‹¤í•¨

@timestamp í•„ë“œ ê¸°ì¤€ìœ¼ë¡œ ì‹œê°„ í•„í„° ê¼­ í™•ì¸

ë¡œê·¸ê°€ ìˆ˜ì§‘ë˜ì§€ ì•Šìœ¼ë©´ Spring ë¡œê·¸ íŒŒì¼ì´ ì‹¤ì œë¡œ ìƒì„±ë˜ëŠ”ì§€ë¶€í„° í™•ì¸

LogstashëŠ” ë¡œê·¸ íŒŒì¼ì˜ ë³€ê²½ì„ ê°ì§€í•˜ë¯€ë¡œ, ë¡œê·¸ê°€ ì‹¤ì œë¡œ append ë˜ì–´ì•¼ ë™ì‘í•¨